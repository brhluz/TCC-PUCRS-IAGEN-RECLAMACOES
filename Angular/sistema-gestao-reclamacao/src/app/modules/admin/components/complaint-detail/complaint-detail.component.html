<div class="detail-container" *ngIf="!loading && complaint" [formGroup]="resolutionForm">
  <div class="ticket-header">
    <div>
      <a class="back-link" (click)="goBack()">← Voltar para lista</a>
      <h1 class="ticket-title">Reclamação {{ complaint.protocol }}</h1>
    </div>

    <div class="status-actions">
      <span class="action-label">Alterar Status:</span>

      <select class="select-status" formControlName="status">
        <option *ngFor="let st of statuses" [value]="st.value">{{ st.label }}</option>
      </select>

      <button class="btn-action btn-save" (click)="saveChanges()" [disabled]="saving">
        {{ saving ? 'Salvando...' : 'Salvar Alteração' }}
      </button>
    </div>
  </div>

  <div class="ticket-body">
    <div class="main-col">
      <div class="detail-label">Descrição do Cliente</div>
      <div class="complaint-text">
        "{{ complaint.description }}"
      </div>

      <div class="resolution-section">
        <div class="detail-label">Resolução / Nota Interna</div>
        <textarea
          class="resolution-textarea"
          formControlName="resolution"
          placeholder="Escreva a resolução aqui..."></textarea>
      </div>
    </div>

    <div class="side-col">
      <div class="ai-box">
        <div class="ai-title">✨ Análise da IA</div>
        <div class="detail-label ai-label">Categoria</div>
        <div class="ai-value">{{ complaint.aiCategory }}</div>
      </div>

      <div class="info-row">
        <div class="detail-label">Cliente</div>
        <div class="info-value">{{ complaint.customerName }}</div>
        <div class="info-email">{{ complaint.customerEmail }}</div>
      </div>

      <div class="info-row">
        <div class="detail-label">Data de Abertura</div>
        <div class="info-value">{{ formatDate(complaint.createdAt) }}</div>
      </div>
    </div>
  </div>
</div>

<div class="loading" *ngIf="loading">Carregando detalhes...</div>
